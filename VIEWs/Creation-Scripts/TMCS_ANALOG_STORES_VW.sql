CREATE OR REPLACE FORCE EDITIONABLE VIEW TMCS_ANALOG_STORES_VW (STORE_ID, STORE_NUMBER, TA_TYPE, TOTAL_POPULATION, POPULATION_DENSITY, DAYTIME_POPULATION, MEDIAN_HH_INCOME, POPULATION_AGE_13, POPULATION_AGE_24, TOTAL_HOUSEHOLDS, HOUSEHOLDS_W_CHILDREN, LANDSCAPE_AFFLUENT, LANDSCAPE_MIDDLE_CLASS, LANDSCAPE_LOWER_INCOME_RURAL, TOTAL_ESTABLISHMENTS, TOTAL_EMPLOYEES, EMPLOYESS_AS_PCT_RESIDENTIAL, WHITE_COLLAR_EMPLOYEES, RETAIL_TRADE_ESTABLISHMENTS, TOTAL_GLA, QSR_DONUTS, QSR_ICE_CREAM, DD_EAB_QTY, DD_TOTAL_AWS, BR_EAB_QTY, BR_TOTAL_AWS, STORE_NAME, ADDRESS, CITY, STATE, COUNTY, NEIGHBORHOOD, COUNTRY, ZIP, FULL_ADDRESS, LONGITUDE, LATITUDE, STATUS, MARKET_NAME, GEOMETRY, CY_ANNUAL_SALES, SIS_TYPE_CODE, LOCATION_TYPE_CODE, STORE_SIZE, TOTAL_ANNUAL_RENT, BASE_RENT_PER_SIZE, OPEN_DATE, CLOSE_DATE, LEASE_EXP_DATE, LEASE_OPTION, CY_TRL_12_MO_SALES, PY_TRL_12_MO_SALES, PCT_DIFF_SALES, CY_EBITDA, PY_EBITDA, PCT_DIFF_EBITDA, PERIOD_ENDING, C_EXT_ATTR1, C_EXT_ATTR2, C_EXT_ATTR3, C_EXT_ATTR4, C_EXT_ATTR5, C_EXT_ATTR6, C_EXT_ATTR7, C_EXT_ATTR8, C_EXT_ATTR9, C_EXT_ATTR10, C_EXT_ATTR11, C_EXT_ATTR12, C_EXT_ATTR13, C_EXT_ATTR14, C_EXT_ATTR15, N_EXT_ATTR1, N_EXT_ATTR2, N_EXT_ATTR3, N_EXT_ATTR4, N_EXT_ATTR5, N_EXT_ATTR6, N_EXT_ATTR7, N_EXT_ATTR8, N_EXT_ATTR9, N_EXT_ATTR10, N_EXT_ATTR11, N_EXT_ATTR12, N_EXT_ATTR13, N_EXT_ATTR14, N_EXT_ATTR15, D_EXT_ATTR1, D_EXT_ATTR2, D_EXT_ATTR3, D_EXT_ATTR4, D_EXT_ATTR5, D_EXT_ATTR6, D_EXT_ATTR7, D_EXT_ATTR8, D_EXT_ATTR9, D_EXT_ATTR10, D_EXT_ATTR11, D_EXT_ATTR12, D_EXT_ATTR13, D_EXT_ATTR14, D_EXT_ATTR15, CBSA_CLASS, STORE_CLASS, ORG_ID, CLIENT_ID, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY, LAST_UPDATE_LOGIN, OBJECT_VERSION_NUMBER, C_EXT_ATTR16, C_EXT_ATTR17, C_EXT_ATTR18, C_EXT_ATTR19, C_EXT_ATTR20, C_EXT_ATTR21, C_EXT_ATTR22, C_EXT_ATTR23, C_EXT_ATTR24, C_EXT_ATTR25, C_EXT_ATTR26, C_EXT_ATTR27, C_EXT_ATTR28, C_EXT_ATTR29, C_EXT_ATTR30, N_EXT_ATTR16, BRAND_ID, N_EXT_ATTR17, N_EXT_ATTR18, N_EXT_ATTR19, N_EXT_ATTR20, N_EXT_ATTR21, N_EXT_ATTR22, N_EXT_ATTR23, N_EXT_ATTR24, N_EXT_ATTR25, C_EXT_ATTR31, C_EXT_ATTR32, C_EXT_ATTR33, C_EXT_ATTR34, C_EXT_ATTR35, C_EXT_ATTR36, C_EXT_ATTR37, C_EXT_ATTR38, C_EXT_ATTR39, C_EXT_ATTR40, C_EXT_ATTR41, C_EXT_ATTR42, C_EXT_ATTR43, C_EXT_ATTR44, ADDRESS2, OUTBOUND_INTEG_FLAG, N_EXT_ATTR26, N_EXT_ATTR27, N_EXT_ATTR28, N_EXT_ATTR29, N_EXT_ATTR30, C_EXT_ATTR45, MI_PRINX, SITE_ID, SITE_SCORE, DEMO_SCORE, TA_N_EXT_ATTR29, TA_N_EXT_ATTR30) AS
  SELECT S.Store_ID,
          S.STORE_NUMBER,
          TA_TYPE,
          TA.N_EXT_ATTR1,
          TA.N_EXT_ATTR2,
          TA.N_EXT_ATTR3,
          TA.N_EXT_ATTR4,
          TA.N_EXT_ATTR5,
          TA.N_EXT_ATTR6,
          TA.N_EXT_ATTR7,
          TA.N_EXT_ATTR8,
          TA.N_EXT_ATTR9,
          TA.N_EXT_ATTR10,
          TA.N_EXT_ATTR11,
          TA.N_EXT_ATTR12,
          TA.N_EXT_ATTR13,
          TA.N_EXT_ATTR14,
          TA.N_EXT_ATTR15,
          TA.N_EXT_ATTR16,
          TA.N_EXT_ATTR17,
          TA.N_EXT_ATTR18,
          TA.N_EXT_ATTR19,
          TA.N_EXT_ATTR20,
          TA.N_EXT_ATTR21,
          TA.N_EXT_ATTR22,
          TA.N_EXT_ATTR23,
          STORE_NAME,
          ADDRESS,
          CITY,
          STATE,
          COUNTY,
          NEIGHBORHOOD,
          COUNTRY,
          ZIP,
          FULL_ADDRESS,
          LONGITUDE,
          LATITUDE,
          STATUS,
          MARKET_NAME,
          GEOMETRY,
          CY_ANNUAL_SALES,
          SIS_TYPE_CODE,
          LOCATION_TYPE_CODE,
          STORE_SIZE,
          TOTAL_ANNUAL_RENT,
          BASE_RENT_PER_SIZE,
          OPEN_DATE,
          CLOSE_DATE,
          LEASE_EXP_DATE,
          LEASE_OPTION,
          CY_TRL_12_MO_SALES,
          PY_TRL_12_MO_SALES,
          PCT_DIFF_SALES,
          CY_EBITDA,
          PY_EBITDA,
          PCT_DIFF_EBITDA,
          PERIOD_ENDING,
          C_EXT_ATTR1,
          C_EXT_ATTR2,
          C_EXT_ATTR3,
          C_EXT_ATTR4,
          C_EXT_ATTR5,
          C_EXT_ATTR6,
          C_EXT_ATTR7,
          C_EXT_ATTR8,
          C_EXT_ATTR9,
          C_EXT_ATTR10,
          C_EXT_ATTR11,
          C_EXT_ATTR12,
          C_EXT_ATTR13,
          C_EXT_ATTR14,
          C_EXT_ATTR15,
          S.N_EXT_ATTR1,
          S.N_EXT_ATTR2,
          S.N_EXT_ATTR3,
          S.N_EXT_ATTR4,
          S.N_EXT_ATTR5,
          S.N_EXT_ATTR6,
          S.N_EXT_ATTR7,
          S.N_EXT_ATTR8,
          S.N_EXT_ATTR9,
          S.N_EXT_ATTR10,
          S.N_EXT_ATTR11,
          S.N_EXT_ATTR12,
          S.N_EXT_ATTR13,
          S.N_EXT_ATTR14,
          S.N_EXT_ATTR15,
          D_EXT_ATTR1,
          D_EXT_ATTR2,
          D_EXT_ATTR3,
          D_EXT_ATTR4,
          D_EXT_ATTR5,
          D_EXT_ATTR6,
          D_EXT_ATTR7,
          D_EXT_ATTR8,
          D_EXT_ATTR9,
          D_EXT_ATTR10,
          D_EXT_ATTR11,
          D_EXT_ATTR12,
          D_EXT_ATTR13,
          D_EXT_ATTR14,
          D_EXT_ATTR15,
          CBSA_CLASS,
          STORE_CLASS,
          S.ORG_ID,
          S.CLIENT_ID,
          S.CREATION_DATE,
          S.CREATED_BY,
          S.LAST_UPDATE_DATE,
          S.LAST_UPDATED_BY,
          S.LAST_UPDATE_LOGIN,
          OBJECT_VERSION_NUMBER,
          C_EXT_ATTR16,
          C_EXT_ATTR17,
          C_EXT_ATTR18,
          C_EXT_ATTR19,
          C_EXT_ATTR20,
          C_EXT_ATTR21,
          C_EXT_ATTR22,
          C_EXT_ATTR23,
          C_EXT_ATTR24,
          C_EXT_ATTR25,
          C_EXT_ATTR26,
          C_EXT_ATTR27,
          C_EXT_ATTR28,
          C_EXT_ATTR29,
          C_EXT_ATTR30,
          S.N_EXT_ATTR16,
          S.BRAND_ID,
          S.N_EXT_ATTR17,
          S.N_EXT_ATTR18,
          S.N_EXT_ATTR19,
          S.N_EXT_ATTR20,
          S.N_EXT_ATTR21,
          S.N_EXT_ATTR22,
          S.N_EXT_ATTR23,
          S.N_EXT_ATTR24,
          S.N_EXT_ATTR25,
          C_EXT_ATTR31,
          C_EXT_ATTR32,
          C_EXT_ATTR33,
          C_EXT_ATTR34,
          C_EXT_ATTR35,
          C_EXT_ATTR36,
          C_EXT_ATTR37,
          C_EXT_ATTR38,
          C_EXT_ATTR39,
          C_EXT_ATTR40,
          C_EXT_ATTR41,
          C_EXT_ATTR42,
          C_EXT_ATTR43,
          C_EXT_ATTR44,
          ADDRESS2,
          OUTBOUND_INTEG_FLAG,
          S.N_EXT_ATTR26,
          S.N_EXT_ATTR27,
          S.N_EXT_ATTR28,
          S.N_EXT_ATTR29,
          S.N_EXT_ATTR30,
          S.C_EXT_ATTR45,
          MI_PRINX,
          SITE_ID,
          SITE_SCORE,
          DEMO_SCORE,
          TA.N_EXT_ATTR29 TA_N_EXT_ATTR29,
          TA.N_EXT_ATTR30 TA_N_EXT_ATTR30
     FROM TMCS_ANALOG_STORE_TA TA, TMCS_ALL_STORES S
    WHERE S.STORE_ID = Ta.STORE_ID
    AND NVL (S.STATUS, 'NA') != 'C';

