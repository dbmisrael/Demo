CREATE OR REPLACE FORCE EDITIONABLE VIEW TMCS_ALL_STORES_MI (STORE_ID, SITE_ID, STORE_NUMBER, STORE_NAME, BRAND_NAME, ADDRESS, CITY, STATE, ZIP, STATUS, DEVELOPMENT_GROUP, SITE_TYPE_CODE, SITE_TYPE_CATEGORY, SHOP_PHONE, SHOP_DRIVE_THRU_Y_N, GEOMETRY, DD_ORIG_OPEN_DATE, BR_ORIG_OPEN_DATE, DD_CLOSE_DATE, BR_CLOSE_DATE, LEASE_EXP_DATE, LEASE_OPTION, DD_AWS_LFY, CBSA_CLASS, STORE_CLASS, CREATION_DATE, CNTY_NAME, MINI_MKT, SHOP_DEV_TYPE_DESC, SHOP_SQ_FOOT_TOTAL, COUNTY, DD_SHOP_COMP, BR_SHOP_COMP, SHOP_DIR_OPERATIONS, SHOP_MGR_OPERATIONS, CO_BRANDER, DD_IMAGE, BR_IMAGE, MSA_NAME, DMA_NAME, DD_AWS_YTD, DD_WEEKS_REPORTED_LFY, DD_WEEKS_REPORTED_YTD, BR_WEEKS_REPORTED_YTD, MSA, DMA, SHOP_SQ_FOOT_NONRETAIL, BR_SHOP_SDA, DD_FEE_AGREE_EXPIRE_DATE, BR_FEE_AGREE_EXPIRE_DATE, DD_CONTRACTUAL_REMODEL, DD_AMENDED_REMODEL, BR_CONTRACTUAL_REMODEL, BR_AMENDED_REMODEL, DEVELOPMENT_REGION, MARKET_REGION, SHOP_LEGAL_ENTITY_NAME, SHOP_STAKEHOLDERS_NAMES, DD_STAKEHOLDER_LARGEST_1, DD_STAKEHOLDER_LARGEST_2, SHOP_VP_OPERATIONS, DD_SHOP_STATUS, DD_CLOSE_REASON, BR_SHOP_STATUS, BR_CLOSE_REASON, BR_AWS_LFY, BR_AWS_YTD, DD_COMP_GROWTH_YTD, BR_COMP_GROWTH_YTD, BR_WEEKS_REPORTED_LFY, BR_COMP_GROWTH_LFY, ROOFTOP_WEEKS_REPORTED_YTD, ROOFTOP_AWS_YTD, ROOFTOP_SHOP_CLASS, CLIENT_ID, BRAND_ID, MI_PRINX, ADDR2, FULL_ADDRESS, COUNTRY, LONGITUDE, LATITUDE, ROOFTOP_COMP_GROWTH_YTD, ROOFTOP_WEEKS_REPORTED_LFY, ROOFTOP_AWS_LFY, ROOFTOP_COMP_GROWTH_LFY, DD_COMP_GROWTH_LFY) AS
  SELECT   STORE_ID,
            --SUBSTRB (STORE_NUMBER,1,50)
            SITE_ID,
            TRIM (STORE_NUMBER),
            --trim(SUBSTRB (STORE_NAME,1,50))
            STORE_NAME,
            SUBSTRB (ADDRESS2, 1, 40),
            SUBSTRB (ADDRESS, 1, 50) ADDRESS,
            SUBSTRB (CITY, 1, 30),
            SUBSTRB (STATE, 1, 4),
            SUBSTRB (ZIP, 1, 10),
            SUBSTRB (STATUS, 1, 1),
            SUBSTRB (C_EXT_ATTR24, 1, 20),
            LOCATION_TYPE_CODE,
            SUBSTRB (C_EXT_ATTR25, 1, 30),
            SUBSTRB (C_EXT_ATTR18, 1, 10),
            SUBSTRB (C_EXT_ATTR6, 1, 1),
            GEOMETRY,
            --        OPEN_DATE,
            D_EXT_ATTR2,
            D_EXT_ATTR3,
            CLOSE_DATE,
            D_EXT_ATTR7,
            LEASE_EXP_DATE,
            SUBSTRB (LEASE_OPTION, 1, 20),
            CY_TRL_12_MO_SALES,
            --        PY_TRL_12_MO_SALES,
            SUBSTRB (CBSA_CLASS, 1, 1),
            SUBSTRB (STORE_CLASS, 1, 1),
            CREATION_DATE,
            SUBSTRB (COUNTY, 1, 30),
            SUBSTRB (MARKET_NAME, 1, 50),
            SUBSTRB (SIS_TYPE_CODE, 1, 20),
            STORE_SIZE,
            SUBSTRB (C_EXT_ATTR1, 1, 30),
            SUBSTRB (C_EXT_ATTR4, 1, 20),
            SUBSTRB (C_EXT_ATTR5, 1, 20),
            SUBSTRB (C_EXT_ATTR7, 1, 30),
            SUBSTRB (C_EXT_ATTR8, 1, 30),
            SUBSTRB (C_EXT_ATTR9, 1, 30),
            SUBSTRB (C_EXT_ATTR12, 1, 20),
            SUBSTRB (C_EXT_ATTR13, 1, 20),
            SUBSTRB (C_EXT_ATTR14, 1, 50),
            SUBSTRB (C_EXT_ATTR15, 1, 50),
            N_EXT_ATTR1,
            N_EXT_ATTR2,
            N_EXT_ATTR3,
            N_EXT_ATTR6,
            N_EXT_ATTR7,
            N_EXT_ATTR8,
            N_EXT_ATTR10,
            N_EXT_ATTR12,
            D_EXT_ATTR1,
            D_EXT_ATTR4,
            D_EXT_ATTR8,
            D_EXT_ATTR9,
            D_EXT_ATTR12,
            D_EXT_ATTR13,
            SUBSTRB (C_EXT_ATTR16, 1, 25),
            SUBSTRB (C_EXT_ATTR17, 1, 20),
            SUBSTRB (C_EXT_ATTR19, 1, 35),
            SUBSTRB (C_EXT_ATTR20, 1, 75),
            SUBSTRB (C_EXT_ATTR21, 1, 30),
            SUBSTRB (C_EXT_ATTR22, 1, 30),
            SUBSTRB (C_EXT_ATTR23, 1, 20),
            SUBSTRB (C_EXT_ATTR26, 1, 15),
            SUBSTRB (C_EXT_ATTR27, 1, 20),
            SUBSTRB (C_EXT_ATTR28, 1, 15),
            SUBSTRB (C_EXT_ATTR29, 1, 20),
            N_EXT_ATTR17,
            N_EXT_ATTR18,
            N_EXT_ATTR19,
            N_EXT_ATTR21,
            N_EXT_ATTR22,
            N_EXT_ATTR23,
            N_EXT_ATTR24,
            N_EXT_ATTR25,
            SUBSTRB (C_EXT_ATTR35, 1, 20),
            CLIENT_ID,
            BRAND_ID,
            MI_PRINX,
            SUBSTRB (ADDRESS2, 1, 40),
            FULL_ADDRESS,
            SUBSTRB (COUNTRY, 1, 50),
            LONGITUDE,
            LATITUDE,
            N_EXT_ATTR26,
            N_EXT_ATTR27,
            N_EXT_ATTR28,
            N_EXT_ATTR29,
            N_EXT_ATTR30
     --MI_STYLE
     FROM   TMCS_ALL_STORES
     where org_id in (select region_id from tmcs.tmcs_regions where country in ('USA','CAN'))
;

